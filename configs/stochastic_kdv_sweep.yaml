# Stochastic KdV k-FFM Improvement Sweep
# Focus: Improving mean_mse where FFM (independent) currently wins
#
# Current best k-FFM: euclidean_sinkhorn_reg0.1 (mean_mse=0.00137)
# Target to beat: independent/FFM (mean_mse=0.000934)
#
# Strategy:
# 1. Lower Sinkhorn regularization (main hypothesis)
# 2. RBF sigma sweep (find optimal bandwidth for spatial data)
# 3. GP prior tuning (optional, lower priority)

# =============================================================================
# Phase 1: Lower Sinkhorn Regularization
# =============================================================================

euclidean_sinkhorn_reg0.01:
  use_ot: true
  ot_method: sinkhorn
  ot_reg: 0.01
  ot_kernel: euclidean
  ot_coupling: sample

euclidean_sinkhorn_reg0.05:
  use_ot: true
  ot_method: sinkhorn
  ot_reg: 0.05
  ot_kernel: euclidean
  ot_coupling: sample

rbf_sinkhorn_reg0.01:
  use_ot: true
  ot_method: sinkhorn
  ot_reg: 0.01
  ot_kernel: rbf
  ot_coupling: sample
  ot_kernel_params:
    sigma: 5.0

rbf_sinkhorn_reg0.05:
  use_ot: true
  ot_method: sinkhorn
  ot_reg: 0.05
  ot_kernel: rbf
  ot_coupling: sample
  ot_kernel_params:
    sigma: 5.0

# =============================================================================
# Phase 2: RBF Sigma Sweep
# =============================================================================

rbf_sigma0.5_reg0.1:
  use_ot: true
  ot_method: sinkhorn
  ot_reg: 0.1
  ot_kernel: rbf
  ot_coupling: sample
  ot_kernel_params:
    sigma: 0.5

rbf_sigma1.0_reg0.1:
  use_ot: true
  ot_method: sinkhorn
  ot_reg: 0.1
  ot_kernel: rbf
  ot_coupling: sample
  ot_kernel_params:
    sigma: 1.0

rbf_sigma2.0_reg0.1:
  use_ot: true
  ot_method: sinkhorn
  ot_reg: 0.1
  ot_kernel: rbf
  ot_coupling: sample
  ot_kernel_params:
    sigma: 2.0

rbf_sigma10.0_reg0.1:
  use_ot: true
  ot_method: sinkhorn
  ot_reg: 0.1
  ot_kernel: rbf
  ot_coupling: sample
  ot_kernel_params:
    sigma: 10.0

rbf_sigma20.0_reg0.1:
  use_ot: true
  ot_method: sinkhorn
  ot_reg: 0.1
  ot_kernel: rbf
  ot_coupling: sample
  ot_kernel_params:
    sigma: 20.0

# Combined: best sigma candidates with lower reg
rbf_sigma1.0_reg0.05:
  use_ot: true
  ot_method: sinkhorn
  ot_reg: 0.05
  ot_kernel: rbf
  ot_coupling: sample
  ot_kernel_params:
    sigma: 1.0

rbf_sigma2.0_reg0.05:
  use_ot: true
  ot_method: sinkhorn
  ot_reg: 0.05
  ot_kernel: rbf
  ot_coupling: sample
  ot_kernel_params:
    sigma: 2.0

rbf_sigma0.5_reg0.05:
  use_ot: true
  ot_method: sinkhorn
  ot_reg: 0.05
  ot_kernel: rbf
  ot_coupling: sample
  ot_kernel_params:
    sigma: 0.5

# =============================================================================
# Phase 3: Signature Kernel for Spatial Data (Lower Priority)
# =============================================================================

sig_no_time_aug_order2:
  use_ot: true
  ot_method: sinkhorn
  ot_reg: 0.1
  ot_kernel: signature
  ot_coupling: sample
  ot_kernel_params:
    time_aug: false
    lead_lag: false
    dyadic_order: 2
    static_kernel_type: rbf
    static_kernel_sigma: 1.0
    add_basepoint: true
    normalize: true
    max_seq_len: 64
    max_batch: 32

sig_order2_sigma0.5:
  use_ot: true
  ot_method: sinkhorn
  ot_reg: 0.1
  ot_kernel: signature
  ot_coupling: sample
  ot_kernel_params:
    time_aug: true
    lead_lag: false
    dyadic_order: 2
    static_kernel_type: rbf
    static_kernel_sigma: 0.5
    add_basepoint: true
    normalize: true
    max_seq_len: 64
    max_batch: 32

sig_order3:
  use_ot: true
  ot_method: sinkhorn
  ot_reg: 0.1
  ot_kernel: signature
  ot_coupling: sample
  ot_kernel_params:
    time_aug: true
    lead_lag: false
    dyadic_order: 3
    static_kernel_type: rbf
    static_kernel_sigma: 1.0
    add_basepoint: true
    normalize: true
    max_seq_len: 64
    max_batch: 32

sig_reg0.05_order2:
  use_ot: true
  ot_method: sinkhorn
  ot_reg: 0.05
  ot_kernel: signature
  ot_coupling: sample
  ot_kernel_params:
    time_aug: true
    lead_lag: false
    dyadic_order: 2
    static_kernel_type: rbf
    static_kernel_sigma: 1.0
    add_basepoint: true
    normalize: true
    max_seq_len: 64
    max_batch: 32

